---
title: é˜²æŠ–ä¸èŠ‚æµ
date: 2019-12-03 10:44:39
tags: JSä¼˜åŒ–
---
### 1.é˜²æŠ–
âœ¨ ä¸šåŠ¡åœºæ™¯ï¼šä½ å°½ç®¡è§¦å‘äº‹ä»¶ï¼Œä½†æ˜¯æˆ‘ä¸€å®šåœ¨äº‹ä»¶è§¦å‘ n ç§’åæ‰æ‰§è¡Œã€‚
å¦‚æœä½ åœ¨ä¸€ä¸ªäº‹ä»¶è§¦å‘çš„ n ç§’å†…åˆè§¦å‘äº†è¿™ä¸ªäº‹ä»¶ï¼Œé‚£æˆ‘å°±ä»¥æ–°çš„äº‹ä»¶çš„æ—¶é—´ä¸ºå‡†ï¼Œn ç§’åæ‰æ‰§è¡Œï¼Œ
æ€»ä¹‹ï¼Œå°±æ˜¯è¦ç­‰ä½ è§¦å‘å®Œäº‹ä»¶ n ç§’å†…ä¸å†è§¦å‘äº‹ä»¶ï¼Œæˆ‘æ‰æ‰§è¡Œ.
ç®€å•çš„è¯´æ³•æ˜¯ï¼Œå–å†³äºä¸Šæ¬¡æ²¡æ“ä½œåï¼Œdelayæ—¶é—´åæ‰§è¡Œã€‚

ğŸ‘é€‚ç”¨åœºæ™¯ï¼šinputçš„æ ¼å¼éªŒè¯ã€æäº¤æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼ˆè§¦å‘é¢‘ä¸é‚£ä¹ˆé«˜ï¼‰

ä»‹ç»ä¸‰ä¸ªç‰ˆæœ¬ï¼š

#### 1æŒ‡å®šthis
```javascript
    function debounce(func, wait) {
        var timeout;
        return function() {
            clearTimeout(timeout)
            timeout = setTimeout(func,wait)  // ä¿æŒåªæ˜¯ä¸€ä¸ªå®šæ—¶å™¨
        }
    }
```
 
#### 2 thisæŒ‡å‘ && æŒ‡å®šä¼ å‚ï¼ˆæ¯”å¦‚`event`ï¼‰
```javascript
    function debounce(func, wait) {
        var timeout;
        // console.log(this) // è¿™é‡Œçš„æ—¶å€™æŒ‡å‘window
        return function() {
            var context = this // è¿™é‡Œçš„æ—¶å€™æŒ‡å‘btn å…³é”®æ˜¯ç¼“å­˜è¿™æ—¶å€™çš„this
            var args = arguments
            clearTimeout(timeout)
            timeout = setTimeout(function() {
                //æ²¡ç»‘å®šcontextæ—¶ï¼Œè¿™é‡ŒthisæŒ‡å‘window
                func.apply(context,args)
            }, wait)
        }
    }
```

#### 3 thisæŒ‡å‘ && æŒ‡å®šä¼ å‚ && ç«‹å³æ‰§è¡Œ
```javascript
function debounce(func, wait, immediate) {
        var timeout;
        return function() {
            var context = this
            var args = arguments
            if (timeout) { clearTimeout(timeout) }
            if (immediate) { // ç«‹å³æ‰§è¡Œ
                // timeoutæœ‰å€¼çš„æƒ…å†µä¸‹ï¼Œæ”¹ä¸ºå»¶æ—¶
                var callNow = !timeout
                timeout = setTimeout(function () {
                    timeout = null
                },wait)
                if (callNow) { func.apply(context,args) }
                // è·‘å®Œç«‹å³æ‰§è¡Œï¼Œæ°¸è¿œéƒ½ä¼šæ‰§è¡Œä¸Šé¢çš„timeout = nullï¼Œ
                // ç„¶åä¸‹ä¸€æ¬¡è¿›å…¥åˆ¤æ–­callNowæ—¶ï¼Œåˆä¼šæ˜¯ç«‹å³æ‰§è¡Œã€‚ 
            } else {
                timeout = setTimeout(function () {
                    func.apply(context,args)
                },wait)
            }
        }
    }
```

### 2.èŠ‚æµ
æŒ‰æŒ‡å®šçš„delayæ‰§è¡Œ
 ğŸ‘ é€‚ç”¨åœºæ™¯ï¼šï¼ˆè§¦å‘é¢‘é«˜ï¼‰resize, touchmove, mousemove, scroll åŠ¨ç”»åœºæ™¯

ä¸‹é¢ä»‹ç»ä¸¤ä¸ªç‰ˆæœ¬ï¼š
  
 #### âœ¨ ä½¿ç”¨æ—¶é—´æˆ³
  ä½¿ç”¨æ—¶é—´æˆ³ï¼Œå½“è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å–å‡ºå½“å‰çš„æ—¶é—´æˆ³ï¼Œ
  ç„¶åå‡å»ä¹‹å‰çš„æ—¶é—´æˆ³(æœ€ä¸€å¼€å§‹å€¼è®¾ä¸º 0 )ï¼Œ
  å¦‚æœå¤§äºè®¾ç½®çš„æ—¶é—´å‘¨æœŸï¼Œå°±æ‰§è¡Œå‡½æ•°ï¼Œç„¶åæ›´æ–°æ—¶é—´æˆ³ä¸ºå½“å‰çš„æ—¶é—´æˆ³ï¼Œ
  å¦‚æœå°äºï¼Œå°±ä¸æ‰§è¡Œã€‚
 
<div class="tip">
    ç¬¬ä¸€ä¸‹ä¼šç«‹åˆ»æ‰§è¡Œ
</div>
```javascript
    // +new Date() å°†ä¼šè°ƒç”¨ Date.prototype ä¸Šçš„ valueOf() æ–¹æ³•ï¼Œ
    // Date.prototype.valueæ–¹æ³•ç­‰åŒäºDate.prototype.getTime()
    function throttle(func, wait) {
        var previous = 0
        return function() {
            var now = +new Date() 
            const args = arguments
            const context = this
            if ((now - previous) > wait) {
                func.apply(context,args)
                previous = now
            }
        }
    }
```

#### âœ¨ ä½¿ç”¨å®šæ—¶å™¨
å½“è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œ
å†è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œå¦‚æœå®šæ—¶å™¨å­˜åœ¨ï¼Œå°±ä¸æ‰§è¡Œï¼Œ
ç›´åˆ°å®šæ—¶å™¨æ‰§è¡Œï¼Œç„¶åæ‰§è¡Œå‡½æ•°ï¼Œ
æ¸…ç©ºå®šæ—¶å™¨ï¼Œ
è¿™æ ·å°±å¯ä»¥è®¾ç½®ä¸‹ä¸ªå®šæ—¶å™¨ã€‚
<div class="tip">
    ç¬¬ä¸€ä¸‹ä¼šå»¶æ—¶æ‰§è¡Œ
</div>
```javascript
    function throttle(func, wait) {
            var timeout;
            return function () {
                const context = this
                const args = arguments
                if (!timeout) {
                    timeout = setTimeout(function () {
                        timeout = null
                        func.apply(context, args)
                    }, wait)
                }
            }
        }
```



### 3.ä¸¤è€…çš„å…³è”ä¸åŒºåˆ«
ä¸¤è€…éƒ½æœ‰æ§åˆ¶è§¦å‘çš„æ¬¡æ•°ï¼Œé˜²æŠ–æ§åˆ¶çš„æ›´å‰å®³ï¼ŒèŠ‚æµæ˜¯é™ä½é¢‘ç‡
å‡è®¾æ— é™æ¬¡è§¦å‘ï¼šé˜²æŠ–å‡½æ•°æ°¸è¿œä¸ä¼šçœŸæ­£æ‰§è¡Œï¼ŒèŠ‚æµå‡½æ•°åˆ™ä¼šæŒ‰ç…§é—´éš”æ—¶é—´æ‰§è¡Œã€‚

å‚è€ƒé“¾æ¥ï¼š
[ä¸“æ ](https://zhuanlan.zhihu.com/p/38313717)
[mqyqingfeng  issue](https://github.com/mqyqingfeng/Blog/issues/26)
